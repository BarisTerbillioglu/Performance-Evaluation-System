# API Integration Guide\n\nThis guide explains how the frontend integrates with your .NET Performance Evaluation API using TypeScript interfaces and HTTP-only cookies.\n\n## üîê Authentication\n\n### HTTP-Only Cookie Authentication\nThe API client is configured to use HTTP-only cookies for secure token storage:\n\n```typescript\n// API client automatically handles cookies\nconst api = axios.create({\n  baseURL: CONFIG.API_BASE_URL,\n  withCredentials: true, // Enable HTTP-only cookies\n});\n```\n\n### Authentication Flow\n1. **Login**: Send credentials ‚Üí Server sets HTTP-only cookies\n2. **Requests**: Cookies automatically included\n3. **Token Refresh**: Automatic refresh on 401 errors\n4. **Logout**: Server clears cookies\n\n### Usage in Components\n```typescript\nimport { useAuth } from '@/store';\n\nconst { state, login, logout } = useAuth();\n\n// Login\nawait login({ email: 'user@example.com', password: 'password' });\n\n// Check authentication\nif (state.isAuthenticated) {\n  console.log('User:', state.user);\n}\n\n// Logout\nawait logout();\n```\n\n## üìä TypeScript Interfaces\n\n### Complete DTO Mapping\nAll backend DTOs have been mapped to TypeScript interfaces:\n\n#### Core Entities\n- `UserDto`, `UserListDto`, `UserWithDetailsDto`\n- `EvaluationDto`, `EvaluationListDto`, `EvaluationFormDto`\n- `CriteriaDto`, `CriteriaWithScoreDto`\n- `DepartmentDto`, `TeamDto`, `RoleDto`\n\n#### Request DTOs\n- `LoginRequest`, `CreateUserRequest`\n- `CreateEvaluationRequest`, `UpdateScoreRequest`\n- `CreateDepartmentRequest`, `CreateTeamRequest`\n\n#### Search & Pagination\n- `UserSearchRequest`, `BaseSearchRequest`\n- `PaginatedResponse<T>`\n\n#### Dashboard DTOs\n- `AdminDashboardDto`, `EmployeeDashboardDto`, `EvaluatorDashboardDto`\n\n## üöÄ Service Classes\n\n### Available Services\nEach controller has a corresponding service class:\n\n```typescript\nimport {\n  authService,          // /api/auth/*\n  userService,          // /api/user/*\n  evaluationService,    // /api/evaluation/*\n  criteriaService,      // /api/criteria/*\n  criteriaCategoryService, // /api/criteriacategory/*\n  departmentService,    // /api/department/*\n  roleService,          // /api/role/*\n  teamService,          // /api/team/*\n  dashboardService,     // /api/dashboard/*\n} from '@/services';\n```\n\n### Service Methods\nEach service provides full CRUD operations:\n\n#### User Service Example\n```typescript\n// Get all users\nconst users = await userService.getUsers();\n\n// Get user by ID\nconst user = await userService.getUserById(1);\n\n// Create user\nconst newUser = await userService.createUser({\n  firstName: 'John',\n  lastName: 'Doe',\n  email: 'john@example.com',\n  passwordHash: 'hash',\n  departmentId: 1\n});\n\n// Search users\nconst results = await userService.searchUsers({\n  searchTerm: 'john',\n  departmentId: 1,\n  page: 1,\n  pageSize: 10\n});\n```\n\n#### Evaluation Service Example\n```typescript\n// Get evaluations\nconst evaluations = await evaluationService.getEvaluations();\n\n// Get evaluation form\nconst form = await evaluationService.getEvaluationForm(evaluationId);\n\n// Update score\nconst score = await evaluationService.updateScore(evaluationId, {\n  criteriaId: 1,\n  score: 4\n});\n\n// Add comment\nconst comment = await evaluationService.addComment({\n  scoreId: 1,\n  description: 'Great performance!'\n});\n```\n\n## üîß Error Handling\n\n### Automatic Token Refresh\nThe API client automatically handles token refresh:\n\n```typescript\n// If token expires, automatically refresh and retry\napi.interceptors.response.use(\n  response => response,\n  async error => {\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      // Try to refresh token\n      await api.post('/api/auth/refresh');\n      // Retry original request\n      return api.request(originalRequest);\n    }\n    return Promise.reject(error);\n  }\n);\n```\n\n### Error Types\n```typescript\ninterface ApiError {\n  message: string;\n  status: number;\n  details?: Record<string, unknown>;\n}\n```\n\n### Handling Errors in Components\n```typescript\nimport { useApi } from '@/hooks';\n\nconst { loading, error, execute } = useApi(userService.getUsers);\n\ntry {\n  const users = await execute();\n  setUsers(users);\n} catch (error) {\n  const apiError = error as ApiError;\n  console.error('Failed:', apiError.message);\n}\n```\n\n## üì± React Integration\n\n### Using with Custom Hooks\n```typescript\nimport { useApi } from '@/hooks';\nimport { userService } from '@/services';\n\nconst UserComponent = () => {\n  const { loading, error, execute } = useApi(userService.getUsers);\n  const [users, setUsers] = useState([]);\n\n  useEffect(() => {\n    const loadUsers = async () => {\n      try {\n        const userData = await execute();\n        setUsers(userData);\n      } catch (err) {\n        console.error('Failed to load users:', err);\n      }\n    };\n    loadUsers();\n  }, [execute]);\n\n  if (loading === 'loading') return <div>Loading...</div>;\n  if (error) return <div>Error: {error.message}</div>;\n\n  return (\n    <div>\n      {users.map(user => (\n        <div key={user.id}>{user.firstName} {user.lastName}</div>\n      ))}\n    </div>\n  );\n};\n```\n\n### Protected Routes\n```typescript\nimport { useAuth } from '@/store';\n\nconst ProtectedRoute = ({ children }) => {\n  const { state } = useAuth();\n  \n  if (state.isLoading) return <LoadingSpinner />;\n  if (!state.isAuthenticated) return <Navigate to=\"/login\" />;\n  \n  return children;\n};\n```\n\n## üéØ Best Practices\n\n### 1. Type Safety\n```typescript\n// Always use TypeScript interfaces\nconst createUser = async (userData: CreateUserRequest): Promise<UserDto> => {\n  return await userService.createUser(userData);\n};\n```\n\n### 2. Error Boundaries\n```typescript\n// Wrap API calls in try-catch\ntry {\n  const result = await evaluationService.createEvaluation(data);\n  // Handle success\n} catch (error) {\n  // Handle error appropriately\n  const apiError = error as ApiError;\n  showErrorMessage(apiError.message);\n}\n```\n\n### 3. Loading States\n```typescript\n// Use loading states for better UX\nconst [loading, setLoading] = useState(false);\n\nconst handleSubmit = async () => {\n  setLoading(true);\n  try {\n    await userService.createUser(formData);\n  } finally {\n    setLoading(false);\n  }\n};\n```\n\n### 4. Caching\n```typescript\n// Consider caching frequently accessed data\nconst [departments, setDepartments] = useState([]);\n\nuseEffect(() => {\n  if (departments.length === 0) {\n    departmentService.getDepartments().then(setDepartments);\n  }\n}, [departments]);\n```\n\n## üîç Development Tips\n\n### Environment Configuration\n```typescript\n// Configure API base URL\nexport const CONFIG = {\n  API_BASE_URL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:5282',\n};\n```\n\n### CORS Configuration\nEnsure your .NET API has CORS configured for credentials:\n\n```csharp\n// In your .NET API\nservices.AddCors(options => {\n  options.AddPolicy(\"AllowCredentials\", builder => {\n    builder.WithOrigins(\"http://localhost:3000\")\n           .AllowCredentials()\n           .AllowAnyHeader()\n           .AllowAnyMethod();\n  });\n});\n```\n\n### Cookie Configuration\nMake sure your .NET API sets secure cookie options:\n\n```csharp\nvar cookieOptions = new CookieOptions\n{\n    HttpOnly = true,\n    Secure = false, // Set to true in production with HTTPS\n    SameSite = SameSiteMode.Lax,\n    Expires = DateTime.UtcNow.AddMinutes(15)\n};\n```\n\n## üìû Support\n\nFor additional help:\n1. Check the `examples/apiUsage.ts` file for comprehensive examples\n2. Review the TypeScript interfaces in `src/types/`\n3. Examine service implementations in `src/services/`\n4. Use the browser dev tools to inspect network requests and responses
